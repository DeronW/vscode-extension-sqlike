CREATE TABLE preprocess; APPEND INTO preprocess ID 'http_parse' ACTION http_parse(); APPEND INTO preprocess ID 'init_variables' ACTION SET @a::String(String) = string.length('abc') SET @site_uuid::string = get_http_all_headers('SL-CE-SUID'), SET @src_ip::INET = socket.src_ip, SET @skip_remaining::bOOLEAN(boolean) = false, SET @website_is_defense::BOOLEAN = string.contains_any(@defense_website::ARRAY(STRING), @site_uuid::STRING); APPEND INTO preprocess ID 'set_host' WHERE @host::STRING = '' ACTION SET @host::STRING = inet_to_string(socket.dst_ip); APPEND INTO preprocess ID 'set_src_ip' WHERE string_to_inet(get_http_all_headers('X-Real-IP')) != '::/0'::INET ACTION SET @src_ip::INET = string_to_inet(get_http_all_headers('X-Real-IP')); ENTRYPOINT TABLE main;